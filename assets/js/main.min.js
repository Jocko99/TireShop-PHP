function pretrazi(){let e,i,t,a,n,o;if(e=$("#sirina").val(),i=$("#visina").val(),t=$("#precnik").val(),a=$("#sezona").val(),n=$("#proizvodjac").val(),o=[],"0"==e&&o.push("Izaberite sirinu!"),"0"==i&&o.push("Izaberite visinu!"),"0"==t&&o.push("Izaberite precnik!"),"0"==a&&o.push("Izaberite sezonu!"),"0"==n&&o.push("Izaberite proizvodjaca!"),o.length){let e='<ul class="bg-danger text-center font-weight-bold rounded-lg">';for(let i=0;i<o.length;i++)e+=`<li>${o[i]}<li>`;$("#searchGreske").html(e)}else $("#searchGreske").hide(),$.ajax({url:"logic/pretraga.php",method:"GET",dataType:"json",data:{sirina:e,visina:i,precnik:t,sezona:a,proizvodjac:n,btnSearch:!0},success:function(e,i,t){200==t.status&&pretragaRezultat(e,$("#rezultatPretrage"))},error:function(e,i,t){404==e.status&&$("#greske").removeClass("hide")}})}function pretragaRezultat(e,i){let t="";return e.forEach(e=>{t+=`<div class='col-lg-4 col-md-6 col-sm-6 rounded-lg m-auto'>\n        <div class='item-logo'>\n            <img src="${e.SlikaProizvodjaca}" alt="${e.Naziv}"/>\n        </div>\n        <div class="product-item">\n            <img src="${e.Slika}" alt="${e.Opis}"/>\n        </div>\n        <div class="item-title text-center">\n            <h3>${e.Naziv}</h3>\n            <p>${e.Opis}`,"leto"==e.Sezona?t+="<span><i class='fas fa-sun text-warning'></i></span>":t+='<span><i class="fas fa-snowflake text-white"></i></span>',t+=`\n            </p>\n        </div>\n        <div class="item-desc text-center">\n        <h4>${e.Sirina}/${e.Visina} R${e.Precnik}</h4>\n        <div class='d-flex justify-content-center'>\n        <p class='text-success font-weight-bold h4'>${e.Cena} din</p>\n        </div>\n        <a href='#'><button class='mb-3 dodajUkorpu' data-id="${e.ID}"><i class="fas fa-shopping-cart pr-1"></i>Dodaj u korpu</button></a>\n        </div>\n    </div>`}),i.html(t)}function regexProvera(){let e,i,t,a,n,o,s,r,l;e=$("#ime").val(),i=$("#prezime").val(),t=$("#email").val(),a=$("#pass").val(),n=$("#passPonovo").val(),l=[],s=/^[\w\d\.]+@([a-z\.])+\.[a-z]{2,5}$/,r=/^.{6,50}$/,(o=/^([A-ZŽĐŠ][a-zčćžšđ]{2,15}\s*)+$/).test(e)?$("#imeInfo").addClass("hide"):($("#imeInfo").removeClass("hide"),l.push("Ime mora početi velikim slovom.")),o.test(i)?$("#prezimeInfo").addClass("hide"):($("#prezimeInfo").removeClass("hide"),l.push("Prezime mora početi velikim slovom.")),s.test(t)?$("#emailInfo").addClass("hide"):($("#emailInfo").removeClass("hide"),l.push("Email mora biti u formatu primer@gmail.com.")),r.test(a)?$("#lozinkaInfo").addClass("hide"):($("#lozinkaInfo").removeClass("hide"),l.push("Lozinka mora sadržati najmanje 6 karaktera.")),a!=n?($("#lozinkaPInfo").removeClass("hide"),l.push("Lozinke moraju biti iste.")):$("#lozinkaPInfo").addClass("hide"),l.count||$.ajax({url:"logic/register.php",method:"POST",dataType:"json",data:{ime:e,prezime:i,email:t,pass:a,passPonovo:n,btnRegister:!0},success:function(e,i,t){201==t.status&&(location.href="login.php")},error:function(e,i,t){}})}function navSlide(){$("#sendvic").click(function(){$("#prikazi").find("ul").slideToggle()})}function scroll(){$("#scrollToTop").click(function(){$("html").animate({scrollTop:0},1e3)}),$("#scrollToTop").hide(),$(window).scroll(function(){let e=$("html").offset().top;(e=$(this)[0].scrollY)>500?$("#scrollToTop").show():$("#scrollToTop").hide()})}function dodajKorisnika(){let e,i,t,a,n,o,s,r,l,d;if(e=$("#insertIme").val(),i=$("#insertPrezime").val(),t=$("#insertEmail").val(),a=$("#insertLozinka").val(),n=$("#insertUloga").val(),o=$("#insertStatus").val(),s=[],r=/^[\w\d\.]+@([a-z\.])+\.[a-z]{2,5}$/,d=/^.{6,50}$/,(l=/^([A-ZŽĐŠ][a-zčćžšđ]{2,15}\s*)+$/).test(e)||s.push("Ime mora početi velikim slovom!"),l.test(i)||s.push("Prezime mora početi velikim slovom!"),d.test(a)||s.push("Lozinka treba sadržati najmanje 6 karaktera!"),"0"==n&&s.push("Izaberite ulogu!"),"0"==o&&s.push("Izaberite status!"),s.length){let e='<ul class="bg-danger text-center font-weight-bold rounded-lg">';for(let i=0;i<s.length;i++)e+=`<li>${s[i]}<li>`;$("#greske").html(e)}else $("#greske").hide(),$.ajax({url:"logic/insert.php",method:"POST",dataType:"json",data:{ime:e,prezime:i,email:t,lozinka:a,uloga:n,status:o,btnUnos:!0},success:function(e,i,t){200==t.status&&(alert("Uspesno ste dodali korisnika!"),location.reload())}})}function prikazKorisnika(){$.ajax({url:"logic/prikaz.php",method:"POST",dataType:"json",success:function(e,i,t){if(200==t.status){var a="";e.forEach(e=>{a+=`<tr>\n                            <td>${e.ID}</td><td>${e.Ime}</td><td>${e.Prezime}</td><td>${e.Email}</td><td>${e.Uloga}</td><td>`,1==e.status?a+="aktivan":a+="neaktivan",a+=`</td><td><input type='button' onClick="obrisi('${e.ID}')" value='Obriši' class="adminPanelUredi"/></td>\n                            <td><input type='button' onClick="izmeni('${e.ID}')" value='Izmeni' class="adminPanelUredi"/></td>\n                        </tr>`}),console.log(e),$("#adminPrikazi").html(a)}},error:function(e,i,t){404==e.status&&alert("Nema rezultata"),500==e.status&&alert("Problem,upit nije izvrsen")}})}function obrisi(e){let i=e;$.ajax({url:"logic/obrisiKorisnika.php",method:"POST",dataType:"json",data:{idKorisnika:i},success:function(e,i,t){204==t.status&&(alert("Uspešno obrisan korisnik"),location.reload())},error:function(e,i,t){500==e.status&&alert("Lose napisan upit za brisanje")}})}function izmeni(e){let i=e;$.ajax({url:"logic/prikazKorisnikaUpdate.php",method:"POST",dataType:"json",data:{idKorisnika:i,btnUpdate:!0},success:function(e,i,t){200==t.status&&($("#insertIme").val(e.ime),$("#insertPrezime").val(e.prezime),$("#insertEmail").val(e.email),$("#insertUloga").val(e.uloga_id),$("#insertStatus").val(e.status),$("#hiddenId").val(e.idKorisnik))},error:function(e,i,t){console.log(e)}})}function izmeniKorisnika(){let e,i,t,a,n,o,s,r,l,d,u;if(u=$("#hiddenId").val(),console.log(u),e=$("#insertIme").val(),i=$("#insertPrezime").val(),t=$("#insertEmail").val(),a=$("#insertLozinka").val(),n=$("#insertUloga").val(),o=$("#insertStatus").val(),s=[],r=/^[\w\d\.]+@([a-z\.])+\.[a-z]{2,5}$/,d=/^.{6,50}$/,!(l=/^([A-ZŽĐŠ][a-zčćžšđ]{2,15}\s*)+$/).test(e))return s.push("GRESKA IME"),!1;if(!l.test(i))return s.push("GRESKA Prezime"),!1;if(!d.test(a))return s.push("GRESKA Lozinka"),!1;if("0"==n&&s.push("IZABERITE ULOGU"),"0"==o&&s.push("IZABERITE STATUS!"),s.length){let e="<ul>";return s.forEach(i=>{e+=`<li>${i}</li>`}),e+="</ul>",document.getElementById("greske").innerHTML=e,!1}$.ajax({url:"logic/izmeniKorisnika.php",method:"POST",dataType:"json",data:{hiddenID:u,updateIme:e,updatePrezime:i,updateEmail:t,updateLozinka:a,updateUloga:n,updateStatus:o,btnIzmeni:!0},success:function(e,i,t){204==t.status&&(alert("Uspesno ste izmenili podatke o korisniku!"),location.reload())},error:function(e){console.log(e)}})}function dodajProizvod(){let e,i,t,a,n,o,s,r,l,d,u;if(e=$("#nazivGume").val().trim(),i=$("#opisGume").val(),t=$("#cenaGume").val(),a=$("#sirinaGume").val(),n=$("#visinaGume").val(),o=$("#precnikGume").val(),s=$("#sezonaGume").val(),r=$("#proizvodjacGume").val(),l=[],u=/^.{3,200}$/,(d=/^[\w\s]{3,}$/).test(e)||l.push("Unesite naziv!"),u.test(i)||l.push("Unesite opis!"),"0"==t&&l.push("Unesite cenu!"),"0"==a&&l.push("Izaberite sirinu!"),"0"==n&&l.push("Izaberite visinu!"),"0"==o&&l.push("Izaberite precnik!"),"0"==s&&l.push("Izaberite sezonu!"),"0"==r&&l.push("Izaberite proizvodjaca!"),l.length){let e='<ul class="bg-danger text-center font-weight-bold rounded-lg">';for(let i=0;i<l.length;i++)e+=`<li>${l[i]}<li>`;$("#greskeUnosProizvodi").html(e)}else $("#greskeUnosProizvodi").hide(),$.ajax({url:"logic/dodajProizvod.php",method:"POST",dataType:"json",data:{nazivGume:e,opisGume:i,cenaGume:t,sirinaGume:a,visinaGume:n,precnikGume:o,sezonaGume:s,proizvodjacGume:r,btnAdd:!0},success:function(e,i,t){204==t.status&&(alert("Uspešno dodat proizvod"),location.reload())},error:function(e,i,t){console.log(e)}})}function prikaziGume(){$.ajax({url:"logic/prikazProizvoda.php",method:"GET",dataType:"json",success:function(e,i,t){if(200==t.status){let i='<table class="table">\n                <thead>\n                <tr>\n                    <th>Fotografija</th>\n                    <th>Naziv</th> \n                    <th>Cena</th>\n                    <th>Obriši</th>\n                    <th>Izmeni</th>\n                </tr>\n                </thead>\n                <tbody>';e.forEach(e=>{i+=`<tr>\n                    <td class="product-thumbnail">\n                    <img src="${e.Slika}" alt="${e.Opis}" class="img-fluid imgKorpa">\n                    </td>\n                    <td class="product-name">\n                    <h2 class="h5 text-black">${e.Opis}</h2>\n                    </td>\n                    <td>${e.Cena} din</td>\n                    <td>\n                        <input type="button" onClick="ukloniProizvod('${e.ID}')" value="Obriši" class="adminPanelUredi"/>\n                    </td>\n                    <td>\n                        <input type="button" onClick="izmeniProizvod('${e.ID}')" value="Izmeni" class="adminPanelUredi"/>\n                    </td>\n                </tr>`}),i+=" \n                </tbody>\n            </table>",$("#prikaziGume").html(i)}},error:function(e,i,t){console.log(e)}})}function ukloniProizvod(e){let i=e;$.ajax({url:"logic/obrisiProizvod.php",method:"POST",dataType:"json",data:{idProizvoda:i},success:function(e,i,t){204==t.status&&(alert("Uspešno obrisan korisnik"),location.reload())},error:function(e,i,t){500==e.status&&alert("Loše napisan upit za brisanje")}})}function izmeniProizvod(e){let i=e;$("#nazivGume").focus(),$.ajax({url:"logic/prikazProizvodaUpdate.php",method:"POST",dataType:"json",data:{idProizvoda:i,btnUpdate:!0},success:function(e,i,t){200==t.status&&($("#idGume").val(e.idProizvod),$("#nazivGume").val(e.naziv),$("#opisGume").val(e.opis),$("#cenaGume").val(e.cena),$("#sirinaGume").val(e.idSirina),$("#visinaGume").val(e.idVisina),$("#precnikGume").val(e.idPrecnik),$("#sezonaGume").val(e.idSezona),$("#proizvodjacGume").val(e.idProizvodjac))},error:function(e,i,t){console.log(e)}})}function izmeniProizvodGume(){let e,i,t,a,n,o,s,r,l,d,u,p;if(p=$("#idGume").val(),e=$("#nazivGume").val(),i=$("#opisGume").val(),t=$("#cenaGume").val(),a=$("#sirinaGume").val(),n=$("#visinaGume").val(),o=$("#precnikGume").val(),s=$("#sezonaGume").val(),r=$("#proizvodjacGume").val(),l=[],u=/^.{3,200}$/,(d=/^[\w\s]{3,}$/).test(e)||l.push("Unesite naziv!"),u.test(i)||l.push("Unesite opis!"),"0"==t&&l.push("Unesite cenu!"),"0"==a&&l.push("Izaberite sirinu!"),"0"==n&&l.push("Izaberite visinu!"),"0"==o&&l.push("Izaberite precnik!"),"0"==s&&l.push("Izaberite sezonu!"),"0"==r&&l.push("Izaberite proizvodjaca!"),l.length){let e='<ul class="bg-danger text-center font-weight-bold rounded-lg">';for(let i=0;i<l.length;i++)e+=`<li>${l[i]}<li>`;$("#greskeUnosProizvodi").html(e)}else $("#greskeUnosProizvodi").hide(),$.ajax({url:"logic/izmeniProizvod.php",method:"POST",dataType:"json",data:{hiddenID:p,nazivGume:e,opisGume:i,cenaGume:t,sirinaGume:a,visinaGume:n,precnikGume:o,sezonaGume:s,proizvodjacGume:r,btnEdit:!0},success:function(e,i,t){204==t.status&&alert("Uspešno ažuriran proizvod")},error:function(e,i,t){console.log(e)}})}function korpa(){$.ajax({url:"logic/prikazProizvoda.php",method:"GET",dataType:"json",success:function(e,i,t){if(200==t.status){let i=proizvodiUKorpi(),t=[];getTable(t=e.filter(e=>{for(let t of i)if(e.ID==t.id)return e.kolicina=t.kolicina,!0;return!1}))}},error:function(e){console.log(e)}})}function getTable(e){let i='<table class="table table-bordered mt-3">\n    <thead>\n      <tr>\n        <th class="product-thumbnail">Fotografija</th>\n        <th class="product-thumbnail">Naziv</th> \n        <th class="product-thumbnail">Cena</th>\n        <th class="product-thumbnail">Količina</th>\n        <th class="product-thumbnail">Ukupno</th>\n        <th class="product-thumbnail">Ukloni</th>\n      </tr>\n    </thead>\n    <tbody>';e.forEach(e=>{i+=`<tr>\n        <td class="product-thumbnail">\n          <img src="${e.Slika}" alt="${e.Opis}" class="img-fluid imgKorpa">\n        </td>\n        <td class="product-name">\n          <h2 class="h5 text-black">${e.Naziv}</h2>\n        </td>\n        <td>${e.Cena} din</td>\n        <td>\n          <div class="input-group mb-3" style="max-width: 120px;">\n            <div class="input-group-prepend">\n              <button class="btn btn-outline-danger js-btn-minus" id="minus" type="button">−</button>\n            </div>\n            <input type="text" class="form-control text-center" value="4" placeholder="" aria-label="Example text with button addon" aria-describedby="button-addon1">\n            <div class="input-group-append">\n              <button class="btn btn-outline-primary js-btn-plus" id="plus" type="button">+</button>\n            </div>\n          </div>\n\n        </td>\n        <td>${4*parseInt(e.Cena)} din</td>\n        <td><button class="btn btn-danger btn-sm" onclick='obrisiIzKorpe(${e.ID})'>X</button></td>\n      </tr>`}),i+=" \n    </tbody>\n  </table>",$("#tabelaKorpe").html(i)}function proizvodiUKorpi(){return JSON.parse(localStorage.getItem("proizvodi"))}function dodajUkorpu(){$(".dodajUkorpu").click(function(e){e.preventDefault();let i=$(this).data("id"),t=proizvodiUKorpi();t?t.filter(e=>e.id==i).length?(alert("Proizvod se nalazi u korpi,izaberite drugi."),$(".alert").addClass("hide").slideUp()):function(){let e=proizvodiUKorpi();e.push({id:i,kolicina:1}),localStorage.setItem("proizvodi",JSON.stringify(e)),$(".alert").removeClass("hide")}():function(){let e=[];e[0]={id:i,kolicina:1},localStorage.setItem("proizvodi",JSON.stringify(e)),$(".alert").removeClass("hide")}()})}function obrisiIzKorpe(e){let i=proizvodiUKorpi().filter(function(i){if(i.id!=e)return!0});localStorage.setItem("proizvodi",JSON.stringify(i)),korpa()}function praznaKorpa(){let e=document.createElement("div");e.setAttribute("id","praznaKorpa"),e.setAttribute("class","d-flex align-items-center justify-content-center ");let i=document.createElement("h1");e.append(i);i.append("Korpa je prazna"),i.setAttribute("class","font-weight-light"),$("#tabelaKorpe").html(e),$("#kupi").hide()}function zatvori(){return $(this).parent().addClass("hide")}function kontaktAdmin(){let e,i,t,a,n,o,s,r,l,d;e=$("#kontaktIme").val().trim(),i=$("#kontaktPrezime").val().trim(),t=$("#kontaktEmail").val().trim(),a=$("#kontaktNaslov").val().trim(),n=$("#kontaktPoruka").val().trim(),d=[],s=/^[\w\d\.]+@([a-z\.])+\.[a-z]{2,5}$/,r=/^[\w]{3,20}$/,l=/^.{15,}$/,(o=/^([A-ZŽĐŠ][a-zčćžšđ]{2,15}\s*)+$/).test(e)?$("#kontaktImeInfo").addClass("hide"):($("#kontaktImeInfo").removeClass("hide"),d.push(e)),o.test(i)?$("#kontaktPrezimeInfo").addClass("hide"):($("#kontaktPrezimeInfo").removeClass("hide"),d.push(i)),s.test(t)?$("#kontaktEmailInfo").addClass("hide"):($("#kontaktEmailInfo").removeClass("hide"),d.push(t)),r.test(a)?$("#kontaktNaslovInfo").addClass("hide"):($("#kontaktNaslovInfo").removeClass("hide"),d.push(a)),l.test(n)?$("#kontaktPorukaInfo").addClass("hide"):($("#kontaktPorukaInfo").removeClass("hide"),d.push(n)),d.length||(alert("Poruka uspešno poslata!"),location.reload())}$(document).ready(function(){scroll(),navSlide(),dodajUkorpu(),$(".zatvori").click(zatvori);var e=window.location.href;if(-1!==e.indexOf("index.php"))$("#posalji").on("click",pretrazi);else if(-1!==e.indexOf("gume.php"));else if(-1!==e.indexOf("login.php"))$("#lgReg").click(function(){location.href="registracija.php"});else if(-1!==e.indexOf("registracija.php"))$("#btnReg").on("click",regexProvera);else if(-1!==e.indexOf("admin.php"))$("#dodaj").on("click",dodajKorisnika),$("#izmeni").on("click",izmeniKorisnika),prikazKorisnika(),$("#dodajGumu").on("click",dodajProizvod),prikaziGume(),$("#izmeniGumu").on("click",izmeniProizvodGume);else if(-1!==e.indexOf("kontakt.php"))$("#btnKontakt").on("click",kontaktAdmin);else if(-1!==e.indexOf("korpa.php")){proizvodiUKorpi().length?(korpa(),$("#kupi").show()):praznaKorpa()}});